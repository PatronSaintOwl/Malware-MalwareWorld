# MalwareWorld #

System based on +500 blacklists and 5 external intelligences to detect potencially malicious hosts in internet.

![](https://github.com/carlospolop/MalwareWorld/blob/master/malwareworld.png)

## Description

The library parses more than 500 public blacklists around the internet in order to identify potencially malicious devices.

Among the final blacklist created merging all the others you can find ips, domains and urls that potencially:
-   Are infected with malware
-   Attack other hosts
-   Send spam
-   Contains phishing sites
-   Are bitcoin nodes
-   Are Tor exit nodes
-   Are public proxies
-   Have bad reputation
-   Are related to adware

When you `require` the blacklist it will start accessing and loading all the blacklists. This process could take from 5 to 10 minutes.
The "database" will be a javascript huge dictionary in memmory. Each component will be and IP or Domain or IPRange potencially malicios that will have as atributes:
+ A title
+ An array of types (reason/s why this host is potencially malicious)
+ An array of urls (that points to the malicios part of the host)
+ Location (only filled if it is an IP) 
+ The references that have pointed to this host.

Besides, the API of 5 external intelligences are used to check single IPs or domains not only against the huge database of hosts blacklisted but also against the intelligences. If the ip or domain has something suspicious it will be discovered.

```javascript
malicious_comp = "IP/DOMAIN/RANGE": { 
                    title: "",
                    type: [],
                    urls: [],
                    location : {lat: "", lng: ""},
                    references: []
}
```

## Visual representation of a portion of the final database 

Please visit [MalwareWorld](https://malwareworld.com) to see only the malicios IPs detected by all the blacklists used and represented in a world map (this page loads more than 150.000 points with its descriptions in the map, so it is recommended to open it in a computer and using chrome, it will take between 2 and 5 minutes to load the map. With other browsers it might not load).

Plsea visit [MalwareWorld checker](https://malwareworld.com/check) to check if an IP, domain or Url is suspicious using the **Malwareworld project**

## External Intelligences Used

By default, when you check if an IP, Domain or Url is malicious it will be checked agaist the database created merging all the blacklists and against the activated extrnal inteligences. The external intelligences are:
+ [Fraudguard](https://app.fraudguard.io)
+ [Fortiguard](https://fortiguard.com)
+ [ProjectHoneypot](https://www.projecthoneypot.org)
+ [Spamcop](http://spamcop.net)
+ [Web Of Trust](https://www.mywot.com)

By default, only the intelligences that don't require credentials to be used are activated. These are: **Fortiguard** and **Spamcop**.

If you want to deactivate Frotiguard or Spamcop, use:

`mw.deactivateFortiguard()`

`mw.deactivateSpamcop()`

In order to activate the other intelligences you have to set the credentials:

Activate **Fraudguard**:

`mw.setFraudguardUser("<YOUR USERNAME>");`

`mw.setFraudguardPass("<YOUR PASSWORD>");`

Activate **ProjecHoneypot**:

`mw.setProjecthoneypotKey("<YOUR API KEY>");`

Activate **WOT**:

`mw.setWOTKey("<YOUR WOT API KEY>")`

## Installation

`npm install malwareworld`


## How to use

The library has been made to be as simple as possible to use.
Once the library has had time to load all the blacklists:

`const mw = require('malwareworld')`

### Check if Malicious

You can check if an IP, Domain or URL is malicious just calling:
`mw.isMalicious(<INPUT>)`

```javascript
> mw.isMalicious("70.32.94.216").then(function(result){ 
        console.log(result);
    }, function(err) {
        console.log(err);
});

// Result:
{ malicious: true,
  '70.32.94.216':
   { title: 'honeypot_tracker/Malicious Host/Spammer',
     type: [ 'Bad Reputation', 'Spammer' ],
     urls: [],
     location: { lat: 34.0202, lng: -118.3928 },
     references:
      [ 'https://fraudguard.io/',
        'https://fortiguard.com/search?q=70.32.94.216&engine=8',
        'https://www.spamcop.net/w3m?action=checkblock&ip=70.32.94.216' ] 
   }
}
```

By default this method will check the INPUT against the database created using all the blacklists and against the activated external intelligeces.

If you **don't want to create the database** using the blacklists you can do:

`mw.deactivateBlacklists()`

You can **get all the potencially malicious domains** of the database with their descriptions calling:

`mw.getMalDomainsList()`

You can **get all the potencially malicious IPs** of the database with their descriptions calling:

`mw.getMalIpsList()`

You can **get all the potencially malicious IP Ranges** of the database with their descriptions calling:

`mw.getMalRangesList()`

You can **get all the hosts of type** of the database with their descriptions calling:

`mw.getMalHostsOf(TYPE)`

```javascript
Types: BadReputation, Malware, KnownAttacker, Spammer, Phishing, CryptoCurrencies, Hidesource, Adware, DGA
```

You can **get all the blacklist that does not respond** calling:

`mw.getNotRespondingLists()`

### Statistics

You can get **general statistics** of the status of the database and the blacklists by calling:
```javascript
> mw.getGeneralStatistics()
{ num_ips: 165117,                    // Number of unique malicious IPs found
  num_domains: 118664,                // Number of unique malicious Domains found
  num_ranges: 46089,                  // Number of unique malicious IP Ranges found
  num_blacklists: 522,                // Number of blacklists used
  num_notResponding_blacklists: 0,    // Number of blacklists not loaded
  total_unique: 329870,               // Number of unique malicious hosts
  repeated: 116451,                   // Number of repetitions found between balcklists
  external_sources:                   // Check if the external sources are being used or not
   { fraudguard: false,
     fortiguard: true,
     projecthoneypot: false,
     simplespamcop: true,
     wot: false } 
}
```

You can access how much potencially malicious hosts were contained in each blacklist used and the sha1 of the response body by calling:

`mw.getStatistics()`

### Renew data

You can **reload all the blacklists** calling:

`mw.renewAllData()`

You can **reload all the not responding blacklists** calling:

`mw.renewNotRespondingData()`

You can **set an interval to reload every blacklists** calling:

`mw.renewtAllDataInterval(MINUTES)`

You can set an interval to **reload every not responding blacklists** calling:

`mw.renewNotRespondingDataInterval(MINUTES)`

### Port

You can set the `isMalicious()` function to listen in a port calling:
`mw.listenInPort(PORT)`

### Example

```javascript
const mw = require('malwareworld');

mw.setFraudguardUser("<YOUR USERNAME>");
mw.setFraudguardPass("<YOUR PASSWORD>");
mw.setProjecthoneypotKey("<YOUR API KEY>");
mw.setWOTKey("<YOUR API KEY>");

var day = 24**60;
var hour1   = 1**60;

mw.renewtAllDataInterval(day);      	  // Reload the blacklists every day
mw.renewNotRespondingData(hour1);       // Try to load the not responding blacklists every hour

mw.listenInPort(9999);                  // Expose the isMalicious() funtion in port 9999  

mw.isMalicious("malwareworld.com").then(function(result){  // Check if the domain malwareworld.com is malicious (No, it isn't)
        console.log(result);
    }, function(err) {
        console.log(err);
});

```


## TODO
-   Integrate more blacklists and external intelligences.
-   If you know about blacklists or external intelligences that are not used, please contact me.



## License

The MIT License (MIT)

Copyright (c) 2018 Carlos Polop

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

PLEASE, NOTICE THAT IF YOU ARE PLANNING TO USE THE DATABASE CREATED BY THIS SOFTWARE
WITH COMMERCIAL PURPOSES YOU SHOULD CHECK THE LICENSE ASSOCIATE WITH EACH BLACKLIST
THAT THIS SOFTWARE USES.
